{% extends "base.html" %}
{% block content %}
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center flex-wrap gap-2">
        <span><i class="fas fa-fire"></i> 热门打手</span>
        <a href="{{ url_for('customer_index') }}" class="btn btn-sm btn-outline-primary"><i class="fas fa-list"></i> 价格表</a>
        {% if session.get('customer_id') %}
        <a href="{{ url_for('customer_order') }}" class="btn btn-sm btn-primary"><i class="fas fa-shopping-cart"></i> 创建订单</a>
        {% endif %}
    </div>
    <div class="card-body">
        <p class="text-muted mb-4">按已完成订单数与顾客评分排序，为您展示平台优质打手。</p>
        {% if players %}
        <div class="row g-4">
            {% for item in players %}
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 shadow-sm border-0 rounded-3 overflow-hidden player-card">
                    <div class="card-body text-center">
                        <div class="player-avatar mb-2">
                            <span class="avatar-circle"><i class="fas fa-user"></i></span>
                        </div>
                        <h5 class="mb-1">
                            {{ item.player.player_name or item.player.username }}
                            {% if item.player.is_certified %}
                            <span class="badge bg-success ms-1" title="平台认证"><i class="fas fa-certificate"></i></span>
                            {% endif %}
                        </h5>
                        <div class="d-flex justify-content-center gap-3 flex-wrap mb-2">
                            <span class="badge bg-primary"><i class="fas fa-check-circle"></i> 已完成 {{ item.completed_count }} 单</span>
                            {% if item.avg_rating is not none and item.rating_count > 0 %}
                            <span class="badge bg-warning text-dark"><i class="fas fa-star"></i> {{ "%.1f"|format(item.avg_rating) }} ({{ item.rating_count }} 评)</span>
                            {% else %}
                            <span class="text-muted small">暂无评分</span>
                            {% endif %}
                        </div>
                        {% if item.player.live_room_url %}
                        <a href="{{ item.player.live_room_url }}" target="_blank" rel="noopener" class="btn btn-sm btn-outline-danger mb-2"><i class="fas fa-video"></i> 直播间</a>
                        {% endif %}
                        {% if item.env_photos or item.equip_photos %}
                        <div class="d-flex justify-content-center gap-1 flex-wrap mb-2">
                            {% if item.env_photos %}
                            <a href="{{ url_for('serve_upload', filename=item.env_photos[0]) }}" target="_blank" class="player-showcase-thumb" title="环境照片">
                                <img src="{{ url_for('serve_upload', filename=item.env_photos[0]) }}" alt="环境">
                            </a>
                            {% endif %}
                            {% if item.equip_photos %}
                            <a href="{{ url_for('serve_upload', filename=item.equip_photos[0]) }}" target="_blank" class="player-showcase-thumb" title="代练设备">
                                <img src="{{ url_for('serve_upload', filename=item.equip_photos[0]) }}" alt="设备">
                            </a>
                            {% endif %}
                        </div>
                        {% endif %}
                        {% if item.player.equipment_desc %}
                        <p class="small text-muted mb-1"><i class="fas fa-desktop"></i> {{ item.player.equipment_desc }}</p>
                        {% endif %}
                        {% if item.player.preferred_games %}
                        <p class="small text-muted mb-0"><i class="fas fa-gamepad"></i> {{ item.player.preferred_games }}</p>
                        {% endif %}
                        <a href="{{ url_for('customer_order') }}" class="btn btn-sm btn-outline-primary mt-2">去下单</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-center text-muted">暂无打手展示，敬请期待。</p>
        {% endif %}
    </div>
</div>

<style>
.player-card { transition: transform 0.2s, box-shadow 0.2s; }
.player-card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.1) !important; }
.avatar-circle {
    display: inline-flex; align-items: center; justify-content: center;
    width: 64px; height: 64px; border-radius: 50%;
    background: linear-gradient(135deg, #90caf9, #64b5f6); color: #fff; font-size: 1.5rem;
}
.player-showcase-thumb {
    display: inline-block; width: 56px; height: 56px; border-radius: 8px; overflow: hidden; border: 1px solid #dee2e6;
}
.player-showcase-thumb img { width: 100%; height: 100%; object-fit: cover; }
</style>
{% endblock %}
